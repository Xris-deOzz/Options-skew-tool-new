<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Options Skew Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 300;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.2em;
        }
        .chart-section {
            margin: 40px 0;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .chart-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        .chart-description {
            color: #5a6c7d;
            margin-bottom: 20px;
            line-height: 1.6;
            text-align: center;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .control-group {
            display: inline-block;
            margin: 0 15px;
            vertical-align: top;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }
        input[type="range"] {
            width: 150px;
            margin: 5px 0;
        }
        .value-display {
            font-weight: bold;
            color: #3498db;
            margin-top: 5px;
        }
        .explanation {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
        }
        .explanation h3 {
            margin-top: 0;
            font-size: 1.4em;
        }
        .key-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .point-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
        }
        .point-card h4 {
            color: #2c3e50;
            margin-top: 0;
        }
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
            margin: 20px 0;
        }
        .error {
            background: #ffe6e6;
            color: #d63031;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border: 1px solid #fab1a0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Options Skew Explained</h1>
        <p class="subtitle">Understanding Implied Volatility Patterns Across Strike Prices</p>

        <div class="chart-section">
            <h3 class="chart-title">Interactive Volatility Skew</h3>
            <p class="chart-description">
                Adjust the controls below to see how different market conditions affect the volatility skew pattern
            </p>
            
            <div class="controls">
                <div class="control-group">
                    <label for="skewIntensity">Skew Intensity</label>
                    <input type="range" id="skewIntensity" min="0" max="20" value="10" step="1">
                    <div class="value-display" id="skewValue">10</div>
                </div>
                <div class="control-group">
                    <label for="baseVol">Base Volatility</label>
                    <input type="range" id="baseVol" min="15" max="35" value="25" step="1">
                    <div class="value-display" id="volValue">25%</div>
                </div>
                <div class="control-group">
                    <label for="spotPrice">Current Stock Price</label>
                    <input type="range" id="spotPrice" min="80" max="120" value="100" step="5">
                    <div class="value-display" id="spotValue">$100</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="loading" id="loading1">Loading chart...</div>
                <canvas id="skewChart" style="display: none;"></canvas>
            </div>
        </div>

        <div class="explanation">
            <h3>What is Options Skew?</h3>
            <p>
                Options skew occurs when options with the same expiration date but different strike prices 
                have different implied volatilities. In theory, all options on the same underlying asset 
                should have similar implied volatilities, but in practice, market forces create this skew pattern.
            </p>
        </div>

        <div class="key-points">
            <div class="point-card">
                <h4>üîª Put Skew (Most Common)</h4>
                <p>Out-of-the-money puts have higher implied volatility than at-the-money options. This reflects investors' willingness to pay a premium for downside protection.</p>
            </div>
            <div class="point-card">
                <h4>üìà Why Skew Exists</h4>
                <p>Market makers adjust prices based on supply/demand, crash fears, and hedging needs. Heavy demand for protective puts drives their prices (and implied volatility) higher.</p>
            </div>
            <div class="point-card">
                <h4>üí° Trading Opportunities</h4>
                <p>Traders can exploit skew by buying relatively cheap options and selling expensive ones, or by adjusting their strategies based on the skew pattern.</p>
            </div>
            <div class="point-card">
                <h4>‚ö†Ô∏è Risk Management</h4>
                <p>Skew affects delta hedging, position Greeks, and overall portfolio risk. Understanding skew is crucial for proper risk assessment.</p>
            </div>
        </div>

        <div class="chart-section">
            <h3 class="chart-title">Different Skew Patterns</h3>
            <p class="chart-description">
                Compare different types of skew patterns commonly observed in the market
            </p>
            <div class="chart-container">
                <div class="loading" id="loading2">Loading chart...</div>
                <canvas id="patternsChart" style="display: none;"></canvas>
            </div>
        </div>

        <div class="explanation">
            <h3>Why Skew Matters for Traders</h3>
            <p>
                <strong>Pricing Accuracy:</strong> Skew helps traders identify mispriced options and arbitrage opportunities.<br><br>
                <strong>Risk Assessment:</strong> Different skew levels indicate varying market sentiment and risk perceptions.<br><br>
                <strong>Strategy Selection:</strong> The skew pattern influences which options strategies are most profitable.<br><br>
                <strong>Hedging Efficiency:</strong> Understanding skew improves hedging effectiveness and cost management.
            </p>
        </div>
    </div>

    <script>
        let skewChart, patternsChart;

        // Wait for page to fully load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if Chart.js loaded
            if (typeof Chart === 'undefined') {
                document.getElementById('loading1').innerHTML = '<div class="error">Error: Chart.js library failed to load. Please refresh the page.</div>';
                document.getElementById('loading2').innerHTML = '<div class="error">Error: Chart.js library failed to load. Please refresh the page.</div>';
                return;
            }

            try {
                initializeCharts();
            } catch (error) {
                console.error('Error initializing charts:', error);
                document.getElementById('loading1').innerHTML = '<div class="error">Error loading charts. Check console for details.</div>';
                document.getElementById('loading2').innerHTML = '<div class="error">Error loading charts. Check console for details.</div>';
            }
        });

        // Initialize charts
        function initializeCharts() {
            const ctx1 = document.getElementById('skewChart').getContext('2d');
            const ctx2 = document.getElementById('patternsChart').getContext('2d');

            // Hide loading messages
            document.getElementById('loading1').style.display = 'none';
            document.getElementById('loading2').style.display = 'none';
            document.getElementById('skewChart').style.display = 'block';
            document.getElementById('patternsChart').style.display = 'block';

            // Main interactive skew chart
            skewChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Implied Volatility',
                        data: [],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#3498db',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Implied Volatility vs Strike Price',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Strike Price ($)',
                                font: { size: 14, weight: 'bold' }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Implied Volatility (%)',
                                font: { size: 14, weight: 'bold' }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    elements: {
                        point: {
                            hoverRadius: 8
                        }
                    }
                }
            });

            // Patterns comparison chart
            patternsChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: ['70', '75', '80', '85', '90', '95', '100', '105', '110', '115', '120'],
                    datasets: [
                        {
                            label: 'Normal Skew',
                            data: [35, 32, 29, 27, 25, 24, 23, 24, 25, 26, 27],
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 2,
                            tension: 0.3
                        },
                        {
                            label: 'Steep Skew (Crisis)',
                            data: [45, 40, 35, 31, 28, 26, 25, 27, 29, 31, 33],
                            borderColor: '#f39c12',
                            backgroundColor: 'rgba(243, 156, 18, 0.1)',
                            borderWidth: 2,
                            tension: 0.3
                        },
                        {
                            label: 'Flat/Reverse Skew',
                            data: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30],
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            borderWidth: 2,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Different Market Conditions',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Strike Price ($)',
                                font: { size: 14, weight: 'bold' }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Implied Volatility (%)',
                                font: { size: 14, weight: 'bold' }
                            }
                        }
                    }
                }
            });

            updateSkewChart();
            setupEventListeners();
        }

        // Update the main skew chart based on controls
        function updateSkewChart() {
            if (!skewChart) return;

            const skewIntensity = parseInt(document.getElementById('skewIntensity').value);
            const baseVol = parseInt(document.getElementById('baseVol').value);
            const spotPrice = parseInt(document.getElementById('spotPrice').value);

            // Generate strike prices around the spot
            const strikes = [];
            const vols = [];
            
            for (let i = spotPrice - 30; i <= spotPrice + 30; i += 5) {
                strikes.push(i.toString());
                
                // Calculate moneyness (how far from ATM)
                const moneyness = (i - spotPrice) / spotPrice;
                
                // Create skew pattern - higher vol for OTM puts (negative moneyness)
                let vol = baseVol;
                if (moneyness < 0) {
                    vol += skewIntensity * Math.abs(moneyness) * 2;
                } else {
                    vol += skewIntensity * moneyness * 0.5;
                }
                
                vols.push(Math.round(vol * 100) / 100);
            }

            skewChart.data.labels = strikes;
            skewChart.data.datasets[0].data = vols;
            skewChart.update();
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('skewIntensity').addEventListener('input', function(e) {
                document.getElementById('skewValue').textContent = e.target.value;
                updateSkewChart();
            });

            document.getElementById('baseVol').addEventListener('input', function(e) {
                document.getElementById('volValue').textContent = e.target.value + '%';
                updateSkewChart();
            });

            document.getElementById('spotPrice').addEventListener('input', function(e) {
                document.getElementById('spotValue').textContent = '$' + e.target.value;
                updateSkewChart();
            });
        }
    </script>
</body>
</html>